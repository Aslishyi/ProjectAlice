# Project Alice ğŸ¤–âœ¨

> åŸºäº LangGraph ä¸ FastAPI æ„å»ºçš„ï¼Œå…·å¤‡æƒ…æ„Ÿæ¨¡æ‹Ÿã€ä¸»åŠ¨ç¤¾äº¤æ„è¯†ä¸å¤šæ¨¡æ€æ„ŸçŸ¥èƒ½åŠ›çš„æ‹ŸäººåŒ– AI Agentã€‚

Project Alice ä¸ä»…ä»…æ˜¯ä¸€ä¸ªèŠå¤©æœºå™¨äººï¼Œå¥¹æ˜¯ä¸€ä¸ªæ‹¥æœ‰**é•¿æœŸè®°å¿†**ã€**è§†è§‰æ„ŸçŸ¥**ã€**æ½œæ„è¯†å¿ƒç†æ´»åŠ¨**ä»¥åŠ**ä¸»åŠ¨ç¤¾äº¤æ„æ„¿**çš„æ™ºèƒ½ä½“ã€‚å¥¹è¢«è®¾è®¡ç”¨äºé€šè¿‡ OneBot (v11) åè®®ä¸ QQ ç­‰å³æ—¶é€šè®¯è½¯ä»¶é›†æˆã€‚

## ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

*   **ğŸ§  æ‹ŸäººåŒ–å¿ƒæ™ºæ¨¡å‹ (LangGraph)**
    *   é‡‡ç”¨ LangGraph æ„å»ºå¤æ‚çš„è®¤çŸ¥æµç¨‹ï¼ŒåŒºåˆ†â€œæ˜¾æ„è¯†â€ï¼ˆå›å¤ç”Ÿæˆï¼‰ä¸â€œæ½œæ„è¯†â€ï¼ˆæƒ…ç»ª/è®°å¿†å¤„ç†ï¼‰ã€‚
    *   å…·å¤‡**Filterï¼ˆè¿‡æ»¤å™¨ï¼‰**æœºåˆ¶ï¼Œèƒ½åˆ¤æ–­æ˜¯å¦éœ€è¦å›å¤ï¼Œæ‹’ç»æœºæ¢°å¼åº”ç­”ã€‚
*   **â¤ï¸ æƒ…æ„Ÿä¸å…³ç³»å¼•æ“**
    *   å†…ç½® PAD (Pleasure-Arousal-Dominance) æƒ…æ„Ÿæ¨¡å‹ï¼Œæ‹¥æœ‰ç‹¬ç«‹çš„ `Valence` (æ„‰æ‚¦åº¦)ã€`Arousal` (æ¿€æ´»åº¦) å’Œ `Stamina` (ä½“åŠ›å€¼)ã€‚
    *   ç»´æŠ¤ä¸æ¯ä¸ªç”¨æˆ·çš„**äº²å¯†åº¦**ä¸**å…³ç³»å›¾è°±**ï¼Œå¯¹è¯ç­–ç•¥éšå…³ç³»æ·±æµ…åŠ¨æ€å˜åŒ–ã€‚
*   **ğŸ‘ï¸ å¤šæ¨¡æ€è§†è§‰æ„ŸçŸ¥**
    *   **å±å¹•æ„ŸçŸ¥**ï¼šé€šè¿‡ MSS å®æ—¶ç›‘æ§å±å¹•ï¼Œèƒ½ç†è§£ä½ æ­£åœ¨çœ‹çš„å†…å®¹ï¼ˆéœ€å¼€å¯ Monitorï¼‰ã€‚
    *   **å›¾ç‰‡ç†è§£**ï¼šèƒ½å¤Ÿè¯†åˆ«ç”¨æˆ·å‘é€çš„å›¾ç‰‡ã€è¡¨æƒ…åŒ… (Sticker)ï¼Œå¹¶åšå‡ºç¬¦åˆäººè®¾çš„ååº”ã€‚
*   **ğŸ’¾ æ··åˆè®°å¿†ç³»ç»Ÿ**
    *   **çŸ­æœŸè®°å¿†**ï¼šåŸºäº Token çª—å£çš„å¯¹è¯ä¸Šä¸‹æ–‡ã€‚
    *   **é•¿æœŸè®°å¿† (RAG)**ï¼šä½¿ç”¨ ChromaDB å­˜å‚¨äº‹å®æ€§è®°å¿†ï¼Œå…·å¤‡**å¤œé—´åšæ¢¦ (Dream Cycle)** æœºåˆ¶ï¼Œè‡ªåŠ¨æ•´ç†å’Œå›ºåŒ–ç¢ç‰‡åŒ–ä¿¡æ¯ã€‚
*   **âš¡ ä¸»åŠ¨ç¤¾äº¤ (Proactive Agent)**
    *   ä¸ä»…æ˜¯è¢«åŠ¨é—®ç­”ï¼Œå½“é•¿æ—¶é—´æ²‰é»˜æˆ–æ£€æµ‹åˆ°ç‰¹å®šä¸Šä¸‹æ–‡æ—¶ï¼Œå¥¹ä¼šæ ¹æ®å¥½æ„Ÿåº¦ä¸»åŠ¨å‘èµ·è¯é¢˜ã€‚

## ğŸ› ï¸ æ¶æ„æ¦‚è§ˆ

```mermaid
graph TD
    UserInput --> Filter[Context Filter]
    Filter -- Should Reply? --> Parallel[Parallel Processor]
    Filter -- Ignore --> Summarizer
    
    Parallel --> Psychology[Psychology Node]
    Parallel --> Perception[Vision Node]
    
    Psychology & Perception --> Agent[Unified Agent]
    
    Agent --> Tools[Tool Execution]
    Agent --> MemorySaver[Memory Saver]
    
    Tools --> Agent
    MemorySaver --> Summarizer[Summarizer & History]
    
    subgraph Background
        Proactive[Proactive Engine]
        Dream[Dream Cycle]
    end
```



### 1. ä¾èµ–æ–‡ä»¶ (`requirements.txt`)

```text
langchain>=0.3.0
langchain-openai
langchain-community
langchain-experimental
langgraph
fastapi
uvicorn
python-dotenv
chromadb
pydantic>=2.0
httpx
aiofiles
mss
numpy
Pillow
openai
tavily-python
```

---

### 2. é…ç½®ç¯å¢ƒå˜é‡ (`.env)

åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»º `.env`ã€‚ç”¨æˆ·åªéœ€å¤åˆ¶å¹¶åœ¨å…¶ä¸­å¡«å…¥ Keyã€‚

```ini
# ==============================================
# Model Provider Configuration
# ==============================================
# æ ¸å¿ƒ LLM (æ¨è OpenAI GPT-4o æˆ– Claude 3.5 Sonnet / Qwen 2.5)
OPENAI_API_KEY=your_openai_api_key_here

# ç¡…åŸºæµåŠ¨ (SiliconFlow) é…ç½®
SILICON_API_KEY=your_silicon_key_here
SILICON_BASE_URL=https://api.siliconflow.cn/v1

# æ¨¡å‹åç§°é…ç½®
LLM_MODEL_NAME=Qwen/Qwen2.5-VL-72B-Instruct
SMALL_LLM_MODEL_NAME=Qwen/Qwen2.5-7B-Instruct
EMBEDDING_MODEL_NAME=Qwen/Qwen2.5-Embedding

# ==============================================
# Tools & Search
# ==============================================
TAVILY_API_KEY=your_tavily_key_here
# OPENWEATHER_API_KEY=
# SERPER_API_KEY=

# ==============================================
# LangSmith (å¯é€‰ - ç”¨äºè°ƒè¯• Agent é“¾è·¯)
# ==============================================
LANGCHAIN_TRACING_V2=false
LANGCHAIN_ENDPOINT=https://api.smith.langchain.com
LANGCHAIN_API_KEY=your_langsmith_key

# ==============================================
# Storage & System
# ==============================================
VECTOR_DB_PATH=./data/chroma_db
TIMEZONE=Asia/Shanghai

# QQ è¡¨æƒ…æ˜ å°„æ¨¡å¼ (official, legacy, auto)
QQ_FACE_MAP_MODE=auto
```

---

### 3. å‚»ç“œå¼ä¸€é”®è„šæœ¬

#### Windows ç”¨æˆ· (`install_and_run.bat`)

åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºæ­¤æ–‡ä»¶ï¼ŒåŒå‡»å³å¯å®Œæˆç¯å¢ƒé…ç½®å’Œå¯åŠ¨ã€‚

```batch
@echo off
chcp 65001
title Project Alice - Auto Setup & Launcher

echo ===================================================
echo        Project Alice ä¸€é”®éƒ¨ç½²è„šæœ¬
echo ===================================================

REM 1. æ£€æŸ¥ Python æ˜¯å¦å®‰è£…
python --version >nul 2>&1
if %errorlevel% neq 0 (
    echo [ERROR] æœªæ£€æµ‹åˆ° Pythonï¼Œè¯·å…ˆå®‰è£… Python 3.11 æˆ–ä»¥ä¸Šç‰ˆæœ¬å¹¶æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ã€‚
    pause
    exit /b
)

REM 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
if not exist "venv" (
    echo [INFO] æ­£åœ¨åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ (venv)...
    python -m venv venv
) else (
    echo [INFO] è™šæ‹Ÿç¯å¢ƒå·²å­˜åœ¨ã€‚
)

REM 3. æ¿€æ´»ç¯å¢ƒå¹¶å®‰è£…ä¾èµ–
echo [INFO] æ­£åœ¨æ¿€æ´»ç¯å¢ƒå¹¶æ£€æŸ¥ä¾èµ–...
call venv\Scripts\activate
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple

REM 4. æ£€æŸ¥é…ç½®æ–‡ä»¶
if not exist ".env" (
    echo [WARN] æœªæ£€æµ‹åˆ° .env æ–‡ä»¶ï¼
    echo [INFO] æ­£åœ¨ä»æ¨¡æ¿åˆ›å»º .env æ–‡ä»¶ï¼Œè¯·ç¨åæ‰‹åŠ¨å¡«å…¥ API Keyã€‚
    copy .env.example .env
    echo [INFO] .env æ–‡ä»¶å·²åˆ›å»ºã€‚
    echo.
    echo ---------------------------------------------------
    echo è¯·ç°åœ¨æ‰“å¼€é¡¹ç›®ç›®å½•ä¸‹çš„ .env æ–‡ä»¶ï¼Œå¡«å…¥ä½ çš„ API KEYã€‚
    echo é…ç½®å®Œæˆåï¼ŒæŒ‰ä»»æ„é”®ç»§ç»­å¯åŠ¨æœåŠ¡...
    echo ---------------------------------------------------
    pause
)

REM 5. å¯åŠ¨æœåŠ¡
echo [INFO] æ­£åœ¨å¯åŠ¨ Project Alice æœåŠ¡...
python qq_server.py

pause
```

#### Linux / macOS ç”¨æˆ· (`setup.sh` å’Œ `run.sh`)

**setup.sh** (å®‰è£…):

```bash
#!/bin/bash

echo "=== Project Alice Setup ==="

# æ£€æŸ¥ Python
if ! command -v python3 &> /dev/null; then
    echo "Python3 could not be found. Please install it."
    exit 1
fi

# åˆ›å»º venv
if [ ! -d "venv" ]; then
    echo "Creating virtual environment..."
    python3 -m venv venv
fi

# æ¿€æ´»å¹¶å®‰è£…
source venv/bin/activate
echo "Installing dependencies..."
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple

# é…ç½®æ–‡ä»¶
if [ ! -f ".env" ]; then
    echo "Creating .env from example..."
    cp .env.example .env
    echo "Please edit .env with your API keys."
fi

echo "Setup complete. Use './run.sh' to start."
```

**run.sh** (å¯åŠ¨):

```bash
#!/bin/bash
source venv/bin/activate
echo "Starting Project Alice..."
python3 qq_server.py
```

---

## 

### å‰ç½®è¦æ±‚

1. **Python 3.11+**
2. **OneBot v11 å®¢æˆ·ç«¯**ï¼šä½ éœ€è¦è¿è¡Œä¸€ä¸ªæ”¯æŒ OneBot v11 çš„ QQ å®¢æˆ·ç«¯ï¼ˆå¦‚ [NapCatQQ](https://github.com/NapNeko/NapCatQQ) æˆ– [Lagrange.Core](https://github.com/LagrangeDev/Lagrange.Core)ï¼‰ã€‚

   * é…ç½®å…¶åå‘ WebSocket åœ°å€ä¸ºï¼š`ws://127.0.0.1:6199/ws`

### å®‰è£…æ­¥éª¤

**Windows ç”¨æˆ·ï¼š**

1. ä¸‹è½½æœ¬é¡¹ç›®ä»£ç ã€‚
2. åŒå‡»è¿è¡Œæ ¹ç›®å½•ä¸‹çš„ `install_and_run.bat`ã€‚
3. è„šæœ¬ä¼šè‡ªåŠ¨åˆ›å»ºç¯å¢ƒå¹¶æç¤ºä½ ä¿®æ”¹ `.env` é…ç½®æ–‡ä»¶ã€‚
4. ä¿®æ”¹å®Œæˆåï¼ŒæŒ‰ä»»æ„é”®å¯åŠ¨ã€‚

**Linux / Mac ç”¨æˆ·ï¼š**

1. æ‰“å¼€ç»ˆç«¯ï¼Œè¿›å…¥é¡¹ç›®ç›®å½•ã€‚
2. è¿è¡Œ `chmod +x setup.sh run.sh`ã€‚
3. è¿è¡Œ `./setup.sh` è¿›è¡Œå®‰è£…ã€‚
4. ç¼–è¾‘ `.env` æ–‡ä»¶å¡«å…¥ Keyã€‚
5. è¿è¡Œ `./run.sh` å¯åŠ¨ã€‚

## âš™ï¸ éƒ¨åˆ†é…ç½®è¯´æ˜ (.env)

| å˜é‡å               | è¯´æ˜                        | å¿…å¡«            |
| :---------------- | :------------------------ | :------------ |
| `SILICON_API_KEY` | ç¡…åŸºæµåŠ¨ API Key (ç”¨äº LLM)     | âœ…             |
| `LLM_MODEL_NAME`  | ä¸»æ¨¡å‹åç§° (æ¨è Qwen2.5-VL-72B) | âœ…             |
| `TAVILY_API_KEY`  | Tavily æœç´¢ API (ç”¨äºè”ç½‘æœç´¢)    | âœ…             |
| `VECTOR_DB_PATH`  | å‘é‡æ•°æ®åº“å­˜å‚¨è·¯å¾„                 | âŒ (é»˜è®¤ ./data) |
| `OPENAI_API_KEY`  | (å¯é€‰) å¦‚æœä½¿ç”¨ OpenAI åŸç”Ÿæ¥å£     | âŒ             |

## ğŸ“‚ é¡¹ç›®ç»“æ„

```text
ProjectAlice/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ background/    # åå°ä»»åŠ¡ (åšæ¢¦ã€æ¸…ç†)
â”‚   â”œâ”€â”€ core/          # æ ¸å¿ƒé…ç½®ã€Promptã€å…¨å±€çŠ¶æ€
â”‚   â”œâ”€â”€ graph/         # LangGraph èŠ‚ç‚¹å®šä¹‰ (æ ¸å¿ƒé€»è¾‘)
â”‚   â”œâ”€â”€ memory/        # è®°å¿†æ¨¡å— (å‘é‡åº“ã€å…³ç³»åº“)
â”‚   â”œâ”€â”€ monitor/       # å±å¹•ç›‘æ§æ¨¡å—
â”‚   â”œâ”€â”€ tools/         # å·¥å…·é›† (æœç´¢ã€ç”»å›¾ã€ä»£ç è§£é‡Šå™¨)
â”‚   â””â”€â”€ utils/         # è¾…åŠ©å·¥å…· (QQåè®®è§£æã€å®‰å…¨è¿‡æ»¤)
â”œâ”€â”€ data/              # æ•°æ®åº“ä¸å†å²è®°å½•å­˜å‚¨
â”œâ”€â”€ qq_server.py       # ç¨‹åºä¸»å…¥å£ (FastAPI)
â””â”€â”€ requirements.txt   # ä¾èµ–åˆ—è¡¨
```

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼
æœ¬é¡¹ç›®æ ¸å¿ƒåŸºäº LangGraph å¼€å‘ï¼Œå¦‚æœä½ æƒ³ä¿®æ”¹ Agent çš„è¡Œä¸ºé€»è¾‘ï¼Œè¯·é‡ç‚¹å…³æ³¨ `app/graph/nodes` ç›®å½•ã€‚

## ğŸ“œ è®¸å¯è¯

MIT License

